(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))r(n);new MutationObserver(n=>{for(const o of n)if(o.type==="childList")for(const f of o.addedNodes)f.tagName==="LINK"&&f.rel==="modulepreload"&&r(f)}).observe(document,{childList:!0,subtree:!0});function s(n){const o={};return n.integrity&&(o.integrity=n.integrity),n.referrerPolicy&&(o.referrerPolicy=n.referrerPolicy),n.crossOrigin==="use-credentials"?o.credentials="include":n.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function r(n){if(n.ep)return;n.ep=!0;const o=s(n);fetch(n.href,o)}})();let c=[],m="all",u,i,p,k,g,d;document.addEventListener("DOMContentLoaded",()=>{c=JSON.parse(localStorage.getItem("tasks"))||[],m="all",p=document.getElementById("add-task-btn"),u=document.querySelector(".task-container"),i=document.getElementById("task-input"),k=document.getElementById("counter-tasks"),g=document.getElementById("clear-completed"),g.onclick=T,d=document.getElementById("error-message"),i.addEventListener("input",E),p.onclick=y,i.addEventListener("keypress",e=>e.key==="Enter"&&y()),l()});function v(){return c.filter(e=>m==="active"?!e.completed:m==="completed"?e.completed:!0)}function l(){u.innerHTML="",v().forEach(t=>x(t)),b()}function x(e){const t=document.createElement("li");t.className=`list-item ${e.completed?"completed":""}`,t.dataset.id=e.id;const s=document.createElement("input");s.type="checkbox",s.checked=e.completed,s.onchange=()=>L(e.id);const r=document.createElement("span");r.textContent=e.text,r.ondblclick=()=>h(e.id),r.title="Двойной клик для редактирования";const n=document.createElement("button");n.textContent="❌",n.onclick=()=>C(e.id),t.append(s,r,n),u.appendChild(t)}function h(e){const t=c.find(o=>o.id===e);if(!t||t.completed)return;const s=u.querySelector(`[data-id="${e}"]`),r=s.querySelector("span");s.classList.add("editing"),r.contentEditable=!0,r.textContent=t.text,r.focus();const n=()=>{const o=r.textContent.trim();o&&o!==t.text&&(t.text=o,a(),l()),r.contentEditable=!1,s.classList.remove("editing")};r.onblur=n,r.onkeydown=o=>{o.key==="Enter"?(o.preventDefault(),n()):o.key==="Escape"&&(r.contentEditable=!1,s.classList.remove("editing"),r.blur())}}function L(e){const t=c.find(s=>s.id===e);t&&(t.completed=!t.completed),a(),l()}function C(e){c=c.filter(t=>t.id!==e),a(),l()}function a(){localStorage.setItem("tasks",JSON.stringify(c))}function b(){const e=c.filter(t=>!t.completed).length;k.textContent=`Осталось ${e} активных задач`}function y(){E();const e=i.value.trim();if(e){const t={id:Date.now(),text:e,completed:!1};c.push(t),a(),l(),i.value=""}}function T(){c=c.filter(e=>!e.completed),a(),l()}function E(){i.value.trim().length===0?(i.classList.add("error"),d.textContent="Введите текст задачи",d.classList.add("show")):(i.classList.remove("error"),d.textContent="",d.classList.remove("show"))}
